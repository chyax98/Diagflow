[meta]
language = "svgbob"
description = "轻量级 ASCII 转 SVG 工具，自动识别图形并生成清晰的矢量图"
docs_url = "https://github.com/ivanceras/svgbob"
version = "1.0.0"

[types.diagram]
description = "Svgbob 通用图表，支持框图、流程图、架构图等多种图形"
use_cases = [
  "技术架构图",
  "系统流程图",
  "电路图",
  "UML 图表",
  "网络拓扑图",
  "数据流图",
  "组织结构图"
]

syntax_rules = """
核心语法：
- 矩形框: +--+ 或 .--. 绘制，用 +/- 和 | 组成边框
- 圆角矩形: ( ) 和 ' 组合，如 .---. 配合 ( ) 使用
- 圆形: ( ) 或 .--. 缩小形成圆形，大圆用多层括号
- 箭头: -> 或 <- 或 <-> 或 => 或 <= 或 <=>，自动识别方向
- 虚线: -- 短横线，实线用 - 或 =
- 连接线: 用 - | + 绘制，交叉点自动识别或用 + 标记
- 文本: 直接写在框内或框旁边，保持对齐

箭头类型：
- -> 标准实线箭头
- => 双线箭头（强调/粗箭头）
- -o 圆形端点（聚合关系）
- -*- 菱形端点（组合关系）
- -o) 半圆端点（接口）
- <-> 双向箭头
- <=> 双向粗箭头
- -->> 多段箭头

线型：
- --- 实线（标准）
- ... 点线
- === 粗线（双线）
- - - 虚线（空格分隔）
- _._ 点划线
- ~~~ 波浪线

形状识别：
- /\\ 或 \\/  三角形
- ( ) 圆形或椭圆
- +--+ 矩形（直角）
- .--. 圆角矩形
- <> 菱形
- /--\\ 梯形（上窄下宽）
- \\--/ 倒梯形（上宽下窄）

复杂图形：
- 嵌套框: 在大框内绘制小框
- 分组: 用虚线框包围相关元素
- 标签: 文本放在连接线旁边
- 多点连接: 使用 + 作为分支点
- 斜线连接: 使用 / 和 \\ 绘制斜线

圆形绘制：
- 小圆: ( ) 或 .-.
         '-'
- 中圆: .---.
        (   )
        '---'
- 大圆: .-----.
        /     \\
       (       )
        \\     /
        '-----'

连接线技巧：
- 直线: --- 或 |||
- T 型连接: +-- 或 --+
- 交叉: + 明确标记，或自动识别
- 拐角: +-- 或 --+ 或 +-
- 分支: 一个点连接多条线

文本对齐：
- 框内文本自动居中
- 标签文本放在连接线旁边
- 使用空格调整位置
- 保持等宽字体对齐

高级特性：
- 自动形状识别: Svgbob 智能识别常见图形
- 路径优化: 自动平滑连接线
- 边界检测: 自动识别封闭区域
- 多层嵌套: 支持复杂嵌套结构

Kroki 限制：
- ✓ 完全支持所有箭头和线型
- ✓ 自动识别圆形、矩形、三角形等基础图形
- ✓ 支持复杂连接线和交叉点
- ✓ 智能路径优化和形状识别
- ⚠️ 不支持颜色标记（需外部 CSS）
- ⚠️ 复杂嵌套可能需要手动调整对齐
- ⚠️ 图表尺寸建议 ≤ 100x100 字符
- ⚠️ 非等宽字体可能导致对齐问题

常见错误：
- 框对齐错误
  * ❌ +--+
         |  （右边缘未对齐）
       +--+
  * ✓ +--+
       |  |
       +--+

- 箭头间距错误
  * ❌ +--+->+--+（箭头紧贴框）
  * ✓ +--+ -> +--+（加空格更清晰）

- 连接线断开
  * ❌ +--+  |  （空格导致断开）
  * ✓ +--+
       |

- 圆形绘制失败
  * ❌ ( )（太小无法识别）
  * ✓ .---.
       (   )
       '---'

- 对齐不一致
  * ❌ 混用空格和制表符
  * ✓ 统一使用空格

- 交叉点模糊
  * ❌ 连接线直接穿过
  * ✓ 使用 + 明确标记交叉点

最佳实践：
- 使用等宽字体编辑
- 保持统一的框大小
- 使用 + 明确标记连接点
- 复杂图表分层绘制
- 使用空行分隔逻辑区域
- 标签文本简短明了
- 优先使用简单形状
- 测试不同尺寸的圆形
"""

examples = [
  """    .---.        .---.
   /   \\      /   \\
  ( API )----( DB  )
   \\   /      \\   /
    '---'      '---'
      |          ^
      |          |
      v          |
   .------.      |
   | 缓存 |------'
   '------' """,

  """+----------+     +----------+
|  客户端  | --> |   网关   |
+----------+     +----------+
                      |
                      v
                 +----------+
                 |  服务层  |
                 +----------+
                   |     |
         .---------'     '---------.
         v                         v
    +--------+              +----------+
    | 数据库 |              |  缓存    |
    +--------+              +----------+""",

  """      .-.
     ( 1 )
      '-'
       |
       v
    +-----+
    |  A  |---> B
    +-----+
       |
       +---> C
       |
       v
      .-.
     ( 2 )
      '-'

Legend:
  -> 数据流
  () 起止点
  [] 处理节点""",

  """     .-,( ),-.___ _
  .-( )-.   [___]|=| -->( )
 '-( ).-'       /::/ |_|
   '-'         '-.( ).-'

       __________
 --->[_...__...°]

      \\ ____ __
   --->| | |==|
       |____| | |
       /::::/ |__|""",

  """+------------+      +------------+
|   前端     |----->|   BFF      |
|  React     |      |  Node.js   |
+------------+      +------------+
                           |
                           v
                    +------------+
                    | API 网关   |
                    +------------+
                      /    |    \
         .-----------'     |     '----------.
         v                 v                v
    +--------+        +--------+       +--------+
    | 用户服务|        | 订单服务|       | 支付服务|
    +--------+        +--------+       +--------+
         |                 |                |
         v                 v                v
    +--------+        +--------+       +--------+
    | 用户DB |        | 订单DB |       | 支付DB |
    +--------+        +--------+       +--------+""",

  """        .------.
       /      \\
      ( Start  )
       \\      /
        '--+--'
           |
           v
        .-----.
       /       \\
      < 判断?  >
       \\       /
        '-+-+-'
          | |
    Yes   | |   No
          | |
     .----' '----.
     v            v
  +----+       +----+
  | 处理A |       | 处理B |
  +----+       +----+
     |            |
     '-----+------'
           |
           v
        .-----.
       /      \\
      (  End   )
       \\      /
        '-----'""",

  """    /\\
   /  \\
  /    \\  三角形
 /______\\

 +------+
 |      |
 | 矩形 |  基础形状
 |      |
 +------+

  .----.
 (      )
 (  圆  )  圆形
 (      )
  '----'

    <>
   <  >
  <    >  菱形
   <  >
    <>"""
]
